!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.GameEngine=e():t.GameEngine=e()}(this,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/dist",n(n.s=21)}([function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}},function(t,e){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},n(e)}t.exports=n},function(t,e,n){var r=n(12);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}},function(t,e,n){var r=n(13),i=n(6);t.exports=function(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?i(t):e}},function(t,e,n){var r=n(17);function i(e,n,o){return"undefined"!=typeof Reflect&&Reflect.get?t.exports=i=Reflect.get:t.exports=i=function(t,e,n){var i=r(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}},i(e,n,o||e)}t.exports=i},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e,n){var r=n(14),i=n(15),o=n(10),a=n(16);t.exports=function(t){return r(t)||i(t)||o(t)||a()}},function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}},function(t,e,n){var r=n(9);t.exports=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}},function(t,e,n){var r=n(18),i=n(19),o=n(10),a=n(20);t.exports=function(t,e){return r(t)||i(t,e)||o(t,e)||a()}},function(t,e){function n(e,r){return t.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n(e,r)}t.exports=n},function(t,e){function n(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=n=function(t){return typeof t}:t.exports=n=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(e)}t.exports=n},function(t,e,n){var r=n(9);t.exports=function(t){if(Array.isArray(t))return r(t)}},function(t,e){t.exports=function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(t,e,n){var r=n(2);t.exports=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=r(t)););return t}},function(t,e){t.exports=function(t){if(Array.isArray(t))return t}},function(t,e){t.exports=function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(t,e,n){"use strict";n.r(e),n.d(e,"ArcadePhysics",(function(){return g})),n.d(e,"Body",(function(){return N})),n.d(e,"Container",(function(){return H})),n.d(e,"DisplayObject",(function(){return W})),n.d(e,"EventEmitter",(function(){return X})),n.d(e,"Game",(function(){return Et})),n.d(e,"Keyboard",(function(){return ht})),n.d(e,"Loader",(function(){return tt})),n.d(e,"Mouse",(function(){return yt})),n.d(e,"Renderer",(function(){return Q})),n.d(e,"Scene",(function(){return mt})),n.d(e,"Sprite",(function(){return B})),n.d(e,"Util",(function(){return p})),n.d(e,"store",(function(){return jt}));var r=n(0),i=n.n(r),o=n(1),a=n.n(o);function u(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var s={},l=[],f={delay:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return s[t]?!(s[t]+e>Date.now())&&(s[t]=Date.now(),!0):(s[t]=Date.now(),!0)},generateUid:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,e=d(t),n="",r=!1;l.includes(e);)e=d(t);if(e.length>=8){r=!0;for(var i=0;i<e.length;i++){var o=i/4;v(o)||0===o||(n+="-"),n+=e[i]}}return r?n:e},isInside:function(t,e){return e.x<=t.x&&t.x<=e.x+e.width&&e.y<=t.y&&t.y<=e.y+e.height},removeElements:function(t){var e,n=u(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(t.includes(r)){var i=t.indexOf(r);t.splice(i,1)}}}catch(t){n.e(t)}finally{n.f()}},getScene:function(t){return!t||t instanceof GameEngine.Scene?t:f.getScene(t.parent)},tween:function(t){var e=t.target,n=t.duration,r=t.processer;if(!e)throw new Error("Tween without target object.");var i=Date.now(),o={},a=!1,u=function(){var t=Math.min((Date.now()-i)/n,1);r(e,t,o),t>=1&&(a=!0,o=null,e=null,r=null,u=null,clearInterval(c))};u();var c=setInterval(u);return function(){a||(a=!0,o=null,e=null,r=null,u=null,clearInterval(c))}},getRandomFrom:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e[Math.floor(Math.random()*e.length)]}},h="qwertyuiopasdfghjklzxcvbnm1234567890";function y(){return h[Math.floor(Math.random()*h.length)]}function d(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15,e="";e.length<+t;)e+=y();return e}function v(t){return Number(t)===t&&t%1!=0}var p=f;function m(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return b(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var g=function(){function t(){i()(this,t),this.objects=new Set}return a()(t,[{key:"add",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];this.objects.add(o)}}},{key:"remove",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];this.objects.delete(o)}}},{key:"processing",value:function(){for(var t=Array.from(this.objects),e=0;e<t.length-1;e++)for(var n=t[e],r=n.bodyRect,i=n.tops,o=n.velocity.x,a=n.velocity.y,u=e+1;u<t.length;u++){var c=t[u],s=c.bodyRect,l=c.tops,f=c.velocity.x,h=c.velocity.y;if(!n.static||!c.static){var y,d=!1,v=m(i);try{for(v.s();!(y=v.n()).done;){var b=y.value;if(d=p.isInside({x:b[0]+o,y:b[1]+a},{x:s.x+f,y:s.y+h,width:s.width,height:s.height}))break}}catch(t){v.e(t)}finally{v.f()}if(!1===d){var g,w=m(l);try{for(w.s();!(g=w.n()).done;){var x=g.value;if(d=p.isInside({x:x[0]+f,y:x[1]+h},{x:r.x+o,y:r.y+a,width:r.width,height:r.height}))break}}catch(t){w.e(t)}finally{w.f()}}d&&(n.emit("collision",n,c),c.emit("collision",c,n))}}}}]),t}(),w=n(3),x=n.n(w),S=n(4),k=n.n(S),O=n(2),j=n.n(O),A=n(8),R=n.n(A),E=n(5),P=n.n(E);function I(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return D(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function D(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function T(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var F=new WeakSet,M=new WeakSet,_=function(){function t(){i()(this,t),M.add(this),F.add(this),this.handlers={}}return a()(t,[{key:"on",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];(t=T(this,F,C)).call.apply(t,[this].concat(n))}},{key:"off",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];(t=T(this,M,Y)).call.apply(t,[this].concat(n))}},{key:"emit",value:function(t){if(!this.handlers.hasOwnProperty(t))return!1;for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i,o=I(this.handlers[t]);try{for(o.s();!(i=o.n()).done;){var a=i.value;a.apply(void 0,n)}}catch(t){o.e(t)}finally{o.f()}return!0}}]),t}(),C=function(t,e){this.handlers.hasOwnProperty(t)||(this.handlers[t]=[]),this.handlers[t].push(e)},Y=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.handlers.hasOwnProperty(t))return delete this.handlers[t],e();var n=new SyntaxError("Handler by name { ".concat(t," } not found"));return e(n)},X=_;function U(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=j()(t);if(e){var i=j()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return k()(this,n)}}var W=function(t){x()(n,t);var e=U(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),(t=e.call(this)).uid=p.generateUid(r.uid),t.x=r.x||0,t.y=r.y||0,t.anchorX=r.anchorX||0,t.anchorY=r.anchorY||0,t.width=r.width||0,t.height=r.height||0,t.rotation=r.rotation||0,t.scale=r.scale||1,t.scaleX=r.scaleX||1,t.scaleY=r.scaleY||1,t.parent=null,t.visible=!0,void 0!==r.scale&&t.setScale(r.scale),t}return a()(n,[{key:"setScale",value:function(t){this.scaleX=t,this.scaleY=t}},{key:"setParent",value:function(t){this.parent&&this.parent.remove&&this.parent.remove(this),t&&t.add&&t.add(this),this.parent=t}},{key:"draw",value:function(t){this.visible&&t()}},{key:"absoluteX",get:function(){return this.x-this.anchorX*this.width*this.scaleX},set:function(t){return this.x=t+this.anchorX*this.width*this.scaleX,t}},{key:"absoluteY",get:function(){return this.y-this.anchorY*this.height*this.scaleY},set:function(t){return this.y=t+this.anchorY*this.height*this.scaleY,t}}]),n}(X);function L(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return K(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return K(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function K(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function $(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=j()(t);if(e){var i=j()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return k()(this,n)}}var B=function(t){x()(n,t);var e=$(n);function n(t){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i()(this,n),r=e.call(this,o);var a=o.frame||{},u=o.velocity||{};return r.keysDefault=o.keysDefault||[],r.texture=t,r.frame={x:a.x||0,y:a.y||0,width:a.width||t.width,height:a.height||t.height},r.frameDelay=0,r.frames=[],r.frameNumber=0,r.animations={},r.animation="",r.velocity={x:u.x||0,y:u.y||0},void 0===o.width&&(r.width=r.frame.width),void 0===o.height&&(r.height=r.frame.height),r}return a()(n,[{key:"setFramesCollection",value:function(t){this.frames=t}},{key:"setAnimationsCollection",value:function(t){this.animations=t}},{key:"startAnimation",value:function(t){if(!this.animations.hasOwnProperty(t))return!1;var e=this.animations[t],n=e.duration,r=void 0===n?1/0:n,i=e.keys;this.animation=t,this.frameDelay=r/i.length,this.setFrameByKeys.apply(this,R()(i[0]))}},{key:"setFrameByKeys",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=this.getFrameByKeys.apply(this,e.concat(R()(this.keysDefault)));if(!r)return!1;this.frame.x=r.x,this.frame.y=r.y,this.frame.width=r.width,this.frame.height=r.height,this.width=this.frame.width,this.height=this.frame.height}},{key:"getFrameByKeys",value:function(){for(var t=!1,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i,o=L(this.frames);try{for(o.s();!(i=o.n()).done;){var a=i.value;t=!0;var u,c=L(n);try{for(c.s();!(u=c.n()).done;){var s=u.value;if(!a.keys.includes(s)){t=!1;break}}}catch(t){c.e(t)}finally{c.f()}if(t)return a}}catch(t){o.e(t)}finally{o.f()}}},{key:"tick",value:function(){if(this.animation&&p.delay(this.animation+this.uid,this.frameDelay)){var t=this.animations[this.animation].keys;this.frameNumber=(this.frameNumber+1)%t.length,this.setFrameByKeys.apply(this,R()(t[this.frameNumber]))}this.x+=this.velocity.x,this.y+=this.velocity.y}},{key:"draw",value:function(t,e){var r=this;P()(j()(n.prototype),"draw",this).call(this,(function(){e.save(),e.translate(r.x,r.y),e.rotate(-r.rotation),r.texture&&e.drawImage(r.texture,r.frame.x,r.frame.y,r.frame.width,r.frame.height,r.absoluteX-r.x,r.absoluteY-r.y,r.width*r.scaleX,r.height*r.scaleY),e.restore()}))}}]),n}(W);function z(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=j()(t);if(e){var i=j()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return k()(this,n)}}var N=function(t){x()(n,t);var e=z(n);function n(t){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i()(this,n),(r=e.call(this,t,o)).name=o.name;var a=o.body||{};return r.debug=o.debug||!1,r.static=o.static||!1,r.body={},r.body.x=a.x||0,r.body.y=a.y||0,r.body.width=a.width||1,r.body.height=a.height||1,r}return a()(n,[{key:"isInside",value:function(t,e){return p.isInside({x:t,y:e},this.bodyRect)}},{key:"draw",value:function(t,e){if(this.visible){if(e.save(),e.translate(this.x,this.y),e.rotate(-this.rotation),e.drawImage(this.texture,this.frame.x,this.frame.y,this.frame.width,this.frame.height,this.absoluteX-this.x,this.absoluteY-this.y,this.width*this.scaleX,this.height*this.scaleY),this.debug){var n=this.bodyRect,r=n.x,i=n.y,o=n.width,a=n.height;e.strokeStyle="yellow",e.lineWidth=2,e.fillStyle="rgba(255,0,0,0.3)",e.beginPath(),e.rect(r-this.x,i-this.y,o,a),e.fill(),e.stroke()}e.restore()}}},{key:"bodyRect",get:function(){return{x:this.absoluteX+this.width*this.scaleX*this.body.x,y:this.absoluteY+this.height*this.scaleY*this.body.y,width:this.width*this.scaleX*this.body.width,height:this.height*this.scaleY*this.body.height}}},{key:"tops",get:function(){var t=this.bodyRect,e=t.x,n=t.y,r=t.width,i=t.height;return[[e,n],[e+r,n],[e,n+i],[e+r,n+i]]}}]),n}(B);function G(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return J(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return J(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function J(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function q(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=j()(t);if(e){var i=j()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return k()(this,n)}}var H=function(t){x()(n,t);var e=q(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),(t=e.call(this,r)).displayObjects=[],t}return a()(n,[{key:"add",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach((function(e){t.displayObjects.includes(e)||(t.displayObjects.push(e),e.setParent(t))}))}},{key:"tick",value:function(){this.displayObjects.forEach((function(t){t.tick&&t.tick()}))}},{key:"remove",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach((function(e){if(t.displayObjects.includes(e)){var n=t.displayObjects.indexOf(e);t.displayObjects.splice(n,1),e.setParent(null)}}))}},{key:"draw",value:function(t,e){var r=this;P()(j()(n.prototype),"draw",this).call(this,(function(){e.save(),e.translate(r.x,r.y),e.rotate(r.rotation),e.scale(r.scaleX,r.scaleY);var n,i=G(r.displayObjects);try{for(i.s();!(n=i.n()).done;){n.value.draw(t,e)}}catch(t){i.e(t)}finally{i.f()}e.restore()}))}}]),n}(W),Q=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i()(this,t),this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.width=n.width||50,this.canvas.height=n.height||50,this.background=n.background||"black",this.canvasStyle=n.canvasStyle||{},Object.keys(this.canvasStyle).forEach((function(t){"number"==typeof e.canvasStyle[t]&&(e.canvasStyle[t]=String(e.canvasStyle[t]+"px")),e.canvas.style[t]=e.canvasStyle[t]}))}return a()(t,[{key:"clear",value:function(){this.ctx.fillStyle=this.background,this.ctx.beginPath(),this.ctx.rect(0,0,this.canvas.width,this.canvas.height),this.ctx.fill()}}]),t}();function V(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Z(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Z(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function Z(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var tt=function(){function t(){i()(this,t),this.loadOrder={images:[],jsons:[],sounds:[]},this.resources={images:{},jsons:{},sounds:{}}}return a()(t,[{key:"addImage",value:function(t,e){this.loadOrder.images.push({name:t,src:e})}},{key:"addJson",value:function(t,e){this.loadOrder.jsons.push({name:t,address:e})}},{key:"addSound",value:function(t,e){this.loadOrder.sounds.push({name:t,src:e})}},{key:"getImage",value:function(t){return this.resources.images.hasOwnProperty(t)?this.resources.images[t]:new Error("Image not found. Try to enter valid file name!\n")}},{key:"getJson",value:function(t){return this.resources.jsons.hasOwnProperty(t)?this.resources.jsons[t]:new Error("Json not found. Try to enter valid file name!\n")}},{key:"getSound",value:function(t){return this.resources.sounds[t]}},{key:"load",value:function(e){var n,r=this,i=[],o=V(this.loadOrder.images);try{var a=function(){var e=n.value,o=e.name,a=e.src,u=t.loadImage(a).then((function(t){if(r.resources.images[o]=t,r.loadOrder.images.includes(e)){var n=r.loadOrder.images.indexOf(e);r.loadOrder.images.splice(n,1)}}));i.push(u)};for(o.s();!(n=o.n()).done;)a()}catch(t){o.e(t)}finally{o.f()}var u,c=V(this.loadOrder.jsons);try{var s=function(){var e=u.value,n=e.name,o=e.address,a=t.loadJson(o).then((function(t){if(r.resources.jsons[n]=t,r.loadOrder.jsons.includes(e)){var i=r.loadOrder.jsons.indexOf(e);r.loadOrder.jsons.splice(i,1)}}));i.push(a)};for(c.s();!(u=c.n()).done;)s()}catch(t){c.e(t)}finally{c.f()}var l,f=V(this.loadOrder.sounds);try{var h=function(){var e=l.value,n=e.name,o=e.src,a=t.loadSound(o).then((function(t){if(r.resources.sounds[n]=t,r.loadOrder.sounds.includes(e)){var i=r.loadOrder.sounds.indexOf(e);r.loadOrder.sounds.splice(i,1)}}));i.push(a)};for(f.s();!(l=f.n()).done;)h()}catch(t){f.e(t)}finally{f.f()}Promise.all(i).then(e)}}],[{key:"loadImage",value:function(t){return new Promise((function(e,n){try{var r=new Image;r.onload=function(){return e(r)},r.src=t}catch(t){n(t)}}))}},{key:"loadJson",value:function(t){return new Promise((function(e,n){fetch(t).then((function(t){return t.json()})).then((function(t){return e(t)})).catch((function(t){return n(t)}))}))}},{key:"loadSound",value:function(t){return new Promise((function(e,n){try{var r=new Audio;r.addEventListener("canplaythrough",(function(){return e(r)})),r.src=t}catch(t){n(t)}}))}}]),t}(),et=n(7),nt=n.n(et);function rt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=j()(t);if(e){var i=j()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return k()(this,n)}}var it=function(t){x()(n,t);var e=rt(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),(t=e.call(this,r)).color=r.color||"red",t.radius=r.radius||5,t.startAngle=r.startAngle||0,t.endAngle=r.endAngle||2*Math.PI,t.anticlockwise=r.anticlockwise||!1,t.lineWidth=r.lineWidth||1,t.isFill=r.isFill||!1,t}return a()(n,[{key:"draw",value:function(t,e){var r=this;P()(j()(n.prototype),"draw",this).call(this,(function(){e.fillStyle=e.strokeStyle=r.color,e.lineWidth=r.lineWidth,e.beginPath(),e.arc(r.x,r.y,r.radius,r.startAngle,r.endAngle,r.anticlockwise),r.isFill?e.fill():e.stroke()}))}}]),n}(W),ot=function(t){x()(n,t);var e=rt(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),(t=e.call(this,r)).color=r.color||"red",t.lineWidth=r.lineWidth||1,t.x1=r.x1||0,t.y1=r.y1||0,t.x2=r.x2||0,t.y2=r.y2||0,t}return a()(n,[{key:"draw",value:function(t,e){var r=this;P()(j()(n.prototype),"draw",this).call(this,(function(){e.strokeStyle=r.color,e.lineWidth=r.lineWidth,e.beginPath(),e.moveTo(r.x1,r.y1),e.lineTo(r.x2,r.y2),e.stroke()}))}}]),n}(W),at=function(t){x()(n,t);var e=rt(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),(t=e.call(this,r)).color=r.color||"red",t.lineWidth=r.lineWidth||1,t.x=r.x||0,t.y=r.y||0,t.width=r.width||50,t.height=r.height||50,t.isFill=r.isFill||!1,t}return a()(n,[{key:"draw",value:function(t,e){var r=this;P()(j()(n.prototype),"draw",this).call(this,(function(){e.fillStyle=e.strokeStyle=r.color,e.lineWidth=r.lineWidth,e.beginPath(),e.rect(r.x,r.y,r.width,r.height),r.isFill?e.fill():e.stroke()}))}}]),n}(W),ut=function(t){x()(n,t);var e=rt(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),(t=e.call(this,r)).x=r.x||0,t.y=r.y||0,t.fontSize=r.fontSize||48,t.fontFamily=r.fontFamily||"serif",t.text=r.text||" ",t.isFill=r.isFill||!0,t}return a()(n,[{key:"draw",value:function(t,e){var r=this;P()(j()(n.prototype),"draw",this).call(this,(function(){e.font="".concat(r.fontSize.toString(),"px ").concat(r.fontFamily),e.beginPath(),r.isFill?e.fillText(r.text,r.x,r.y):e.strokeText(r.text,r.x,r.y)}))}}]),n}(W),ct=function(){function t(){i()(this,t)}return a()(t,[{key:"create",value:function(e,n){if(!e)return new SyntaxError("Error -> You do not entered type name.");if(t.list.hasOwnProperty(e)){var r=new(0,t.list[e])(n);return r.type=e,r}console.log(new TypeError("Error -> Primitives list hasn't type ( ".concat(e," )")))}}]),t}();nt()(ct,"list",{Line:ot,Circle:it,Square:at,Text:ut});var st=ct;function lt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ft(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?lt(Object(n),!0).forEach((function(e){nt()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):lt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ht=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i()(this,t),nt()(this,"_self",this),this.keys=ft({arrowUp:!1,arrowDown:!1,arrowLeft:!1,arrowRight:!1,space:!1,escape:!1,enter:!1},n.keys),this.keyEvent.bind(this),this.keysAction=ft({ArrowUp:function(t){e.keys.arrowUp=t},ArrowDown:function(t){e.keys.arrowDown=t},ArrowLeft:function(t){e.keys.arrowLeft=t},ArrowRight:function(t){e.keys.arrowRight=t},Space:function(t){this.keys.space=t},Escape:function(t){this.keys.escape=t},Enter:function(t){this.keys.enter=t}},n.actions),document.body.addEventListener("keydown",(function(t){e.keyEvent(t,!0)})),document.body.addEventListener("keyup",(function(t){e.keyEvent(t,!1)}))}return a()(t,[{key:"keyEvent",value:function(t,e){this.keysAction[t.code]&&"function"==typeof this.keysAction[t.code]&&this.keysAction[t.code].bind(this)(e,this._self)}}]),t}(),yt=function(){function t(e){var n=this;i()(this,t),this.keysEvent={mousedown:{},mouseup:{},contextmenu:{},mousemove:{}},Object.keys(this.keysEvent).forEach((function(t){return e.addEventListener(t.toString(),(function(e){return n.mouseEventHandler.bind(n)(e,t)}))}))}return a()(t,[{key:"mouseEventHandler",value:function(t,e){this.keysEvent[e]=t}}]),t}(),dt=n(6),vt=n.n(dt);function pt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=j()(t);if(e){var i=j()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return k()(this,n)}}var mt=function(t){x()(n,t);var e=pt(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),(t=e.call(this)).autoStart=r.autoStart||!1,t.name=r.name||"",t.status="waiting",t.stage=t.displayObjects,r.loading&&(t.loading=r.loading.bind(vt()(t))),r.init&&(t.init=r.init.bind(vt()(t))),r.update&&(t.update=r.update.bind(vt()(t))),r.beforeDestroy&&(t.beforeDestroy=r.beforeDestroy.bind(vt()(t))),t}return a()(n,[{key:"loading",value:function(){}},{key:"init",value:function(){}},{key:"update",value:function(){}},{key:"beforeDestroy",value:function(){}}]),n}(H),bt=n(11),gt=n.n(bt);function wt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=j()(t);if(e){var i=j()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return k()(this,n)}}function xt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=j()(t);if(e){var i=j()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return k()(this,n)}}function St(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=j()(t);if(e){var i=j()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return k()(this,n)}}var kt=function(t){x()(n,t);var e=St(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return{}},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i()(this,n),t=e.call(this),nt()(vt()(t),"getState",(function(){return t.state})),t.reducer=r,t.state=o||{},t.listeners=[],t.dispatch({type:"__INIT__"}),t}return n}(function(t){x()(n,t);var e=xt(n);function n(){return i()(this,n),e.call(this)}return a()(n,[{key:"dispatch",value:function(t){var e=this;if("function"==typeof t)return t(this.dispatch);this.state=this.reducer(this.state,t),this.listeners.forEach((function(t){return t(e.state)}))}},{key:"subscribe",value:function(t){var e=this;return this.listeners.push(t),{unsubscribe:function(){var n=e.listeners.indexOf(t);e.listeners.splice(n,1)}}}}]),n}(function(t){x()(n,t);var e=wt(n);function n(){var t;return i()(this,n),(t=e.call(this)).data={data:Math.floor(10*Math.random())},t}return a()(n,null,[{key:"combineReducers",value:function(t){return function(e,n){var r={};return Object.entries(t).forEach((function(t){var i=gt()(t,2),o=i[0],a=i[1];r[o]=a(e[o],n)})),r}}}]),n}((function t(){if(i()(this,t),t.exists)return t._instance;t._instance=this,t.exists=!0}))));function Ot(t,e){return new kt(t,e)}kt.combineReducers;var jt=kt;function At(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Rt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Rt(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function Rt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Et=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i()(this,t),this.renderer=new Q(n),this.loader=new tt,this.scenesCollection=new H,this.primitives=new st,this.store=Ot(n.reducer,n.initialState),this.devices={keyboard:new ht(n.extendKeyboardKeys||{}),mouse:new yt(this.renderer.canvas)},n.scenes&&this.addScenes.apply(this,R()(n.scenes)),n.el&&n.el.appendChild&&n.el.appendChild(this.renderer.canvas);var r,o=At(this.scenes);try{for(o.s();!(r=o.n()).done;){var a=r.value;a.primitives=this.primitives}}catch(t){o.e(t)}finally{o.f()}var u,c=this.scenes.filter((function(t){return t.autoStart})),s=At(c);try{for(s.s();!(u=s.n()).done;){var l=u.value;l.status="loading",l.loading(this.loader)}}catch(t){s.e(t)}finally{s.f()}this.loader.load((function(){var t,n=At(c);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.status="initialization",r.init(e.primitives)}}catch(t){n.e(t)}finally{n.f()}var i,o=At(c);try{for(o.s();!(i=o.n()).done;){i.value.status="started"}}catch(t){o.e(t)}finally{o.f()}})),requestAnimationFrame((function(t){return e.tick(t)}))}return a()(t,[{key:"addScenes",value:function(){for(var t,e=this,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(t=this.scenesCollection).add.apply(t,r),r.forEach((function(t){t.parent=e}))}},{key:"tick",value:function(t){var e,n=this,r=this.scenes.filter((function(t){return"started"===t.status})),i=At(r);try{for(i.s();!(e=i.n()).done;){e.value.update(t)}}catch(t){i.e(t)}finally{i.f()}var o,a=At(r);try{for(a.s();!(o=a.n()).done;){o.value.tick(t)}}catch(t){a.e(t)}finally{a.f()}this.renderer.clear();var u,c=At(r);try{for(c.s();!(u=c.n()).done;){u.value.draw(this.renderer.canvas,this.renderer.ctx)}}catch(t){c.e(t)}finally{c.f()}requestAnimationFrame((function(t){return n.tick(t)}))}},{key:"getScene",value:function(t){if(t instanceof mt&&this.scenes.includes(t))return t;if("string"==typeof t){var e,n=At(this.scenes);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(r.name===t)return r}}catch(t){n.e(t)}finally{n.f()}}}},{key:"startScene",value:function(t){var e=this.getScene(t);return!!e&&(e.status="loading",e.loading(this.loader),this.loader.load((function(){e.status="initialization",e.init(),e.status="started"})),!0)}},{key:"finishScene",value:function(t){var e=this.getScene(t);return!!e&&(e.status="Finished",this.scenesCollection.remove(e),e.beforeDestroy(),!0)}},{key:"scenes",get:function(){return this.scenesCollection.displayObjects}}]),t}();Object.assign(Et,{ArcadePhysics:g,Body:N,Primitives:st,Container:H,DisplayObject:W,EventEmitter:X,Game:Et,Keyboard:ht,Loader:tt,Mouse:yt,Renderer:Q,Scene:mt,Sprite:B,Util:p});e.default=Et}])}));